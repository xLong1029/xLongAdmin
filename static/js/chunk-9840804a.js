(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9840804a"],{"39d3":function(t,e,s){"use strict";var a=s("4d5d"),n=s.n(a);n.a},"4d5d":function(t,e,s){},"57f7":function(t,e,s){},"62cd":function(t,e,s){"use strict";var a=s("57f7"),n=s.n(a);n.a},6599:function(t,e,s){"use strict";var a,n=s("bd86"),i=(s("ac6a"),s("456d"),s("56c6"));e["a"]=(a={GetProdList:function(t,e,s){var a=i["a"].GetQuery("Product");return t&&Object.keys(t).length&&(t.id&&a.equalTo("objectId","==",t.id),t.productName&&a.equalTo("productName","==",t.productName),t.dataFrom&&a.equalTo("dataFrom","==",parseInt(t.dataFrom))),new Promise((function(t,n){i["a"].GetListData(a,e,s).then((function(e){return t(e)})).catch((function(t){return n(t)}))}))},AddProduct:function(t){return new Promise((function(e,s){i["a"].AddOne("Product",t).then((function(t){return e(t)})).catch((function(t){return s(t)}))}))},EditProduct:function(t,e){return new Promise((function(s,a){i["a"].EditOne("Product",e,t).then((function(t){return s(t)})).catch((function(t){return a(t)}))}))},DeleteProd:function(t){return new Promise((function(e,s){i["a"].DelMore("Product",t).then((function(t){return e(t)})).catch((function(t){return s(t)}))}))},GetProdInfo:function(t){return new Promise((function(e,s){i["a"].GetOne("Product",t).then((function(t){return e(t)})).catch((function(t){return s(t)}))}))}},Object(n["a"])(a,"EditProduct",(function(t,e){return new Promise((function(s,a){i["a"].EditOne("Product",e,t).then((function(t){return s(t)})).catch((function(t){return a(t)}))}))})),Object(n["a"])(a,"GetCaseList",(function(t){return new Promise((function(e,s){i["a"].GetOne("Product",t).then((function(t){return e({code:200,data:t.data.caseList})})).catch((function(t){return s(t)}))}))})),Object(n["a"])(a,"AddCase",(function(t,e){var s=i["a"].GetQuery("Product");return new Promise((function(a,n){s.get(e).then((function(e){var s=e.caseList?e.caseList:[];s.push(t),e.set("caseList",s),e.save().then((function(){return a({code:200,msg:"操作成功！"})})).catch((function(t){return n(t)}))})).catch((function(){return a({code:404,msg:"对象不存在！"})}))}))})),Object(n["a"])(a,"EditCase",(function(t,e,s){var a=i["a"].GetQuery("Product");return new Promise((function(n,i){a.get(e).then((function(e){var a=e.caseList?e.caseList:[];a.splice(s,1,t),e.set("caseList",a),e.save().then((function(){return n({code:200,msg:"操作成功！"})})).catch((function(t){return i(t)}))})).catch((function(){return n({code:404,msg:"对象不存在！"})}))}))})),Object(n["a"])(a,"DelCase",(function(t,e){var s=i["a"].GetQuery("Product");return new Promise((function(a,n){s.get(t).then((function(t){var s=t.caseList?t.caseList:[];s.splice(e,1),t.set("caseList",s),t.save().then((function(){return a({code:200,msg:"操作成功！"})})).catch((function(t){return n(t)}))})).catch((function(){return a({code:404,msg:"对象不存在！"})}))}))})),a)},7457:function(t,e,s){"use strict";var a=s("c339"),n=s.n(a);n.a},"867b":function(t,e,s){"use strict";var a=s("de2e"),n=s.n(a);n.a},a6c3:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-Upload",attrs:{id:"singleImage"}},[""!=t.getImageUrl?s("div",{staticClass:"upload-show"},[s("div",{staticClass:"upload-img-wrap"},[s("img",{staticClass:"upload-image",attrs:{src:t.getImageUrl,alt:"图片加载失败"},on:{error:t.notFoundPic}})]),t.preview?s("div",{staticClass:"upload-mask"},[t.preview?s("Icon",{staticClass:"g-mr10",attrs:{type:"md-eye"},nativeOn:{click:function(e){return t.viewImage(e)}}}):t._e(),s("Icon",{attrs:{type:"md-create"},nativeOn:{click:function(e){return t.uploadClick(e)}}})],1):t._e()]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showUploadBtn,expression:"showUploadBtn"}],staticClass:"upload-btn",on:{click:t.uploadClick}},[s("Icon",{attrs:{type:"md-camera",size:"20"}}),s("input",{ref:"imgFile",attrs:{type:"file",accept:t.format,hidden:""},on:{change:t.selectFile}})],1),"finished"!=t.uploadStatus?[t.showProgress?s("Progress",{staticStyle:{width:"340px"},attrs:{percent:t.percentage,"hide-info":"","stroke-width":3}}):t._e()]:t._e(),s("br"),s("span",{staticClass:"hint"},[t._v("\n    * 图片格式要求：jpg、jpeg、png，文件大小为\n    "),t.fileSize<1024?s("span",[t._v(t._s(t.fileSize)+"kb")]):s("span",[t._v(t._s(Math.floor(t.fileSize/1024))+"M")]),t._v("\n    以内。\n  ")]),s("div",{staticClass:"clearfix"}),s("Modal",{staticClass:"m-view-img",attrs:{title:"查看图片",width:"600"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("img",{attrs:{src:t.getImageUrl},on:{error:t.notFoundPic}}),s("div",{attrs:{slot:"footer"},slot:"footer"})])],2)},n=[],i=(s("7f7f"),s("c5f6"),s("ff51"),s("1b62")),o={name:"singleImage",mixins:[i["f"]],props:{src:{type:String,default:""},preview:{type:Boolean,default:!1},sizeHint:{type:String,default:"100*100px"},fileSize:{type:Number,default:150}},watch:{src:function(t){this.showUploadBtn=!t,this.getImageUrl=t}},data:function(){return{getImageUrl:this.src,showUploadBtn:!this.src}},methods:{uploadFile:function(t){var e=this;this.progressShow();var s=Bmob.File(t.name,t);this.uploadToBomb(s).then((function(t){e.getImageUrl=t[0].url,e.$emit("update:src",e.getImageUrl),e.$emit("get-img-url",e.getImageUrl)})).catch((function(t){return console.log(t)}))}}},r=o,c=(s("62cd"),s("2877")),u=Object(c["a"])(r,a,n,!1,null,"3111636a",null);e["a"]=u.exports},c339:function(t,e,s){},dce2:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"g-content"},[s("Tabs",{staticClass:"m-tabs",attrs:{type:"card",animated:!1}},[s("TabPane",{attrs:{label:"基本信息"}},[s("div",{staticClass:"tabs-cont"},[s("ProductInfo",{attrs:{"product-id":t.productId}})],1)]),s("TabPane",{attrs:{label:"案例展示"}},[s("div",{staticClass:"tabs-cont"},[s("CaseList",{attrs:{"product-id":t.productId}})],1)])],1),s("Button",{staticClass:"u-btn-goback fr",attrs:{type:"default"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1)},n=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-product-info"},[t.pageLoading?s("Loading"):s("div",[s("Form",{ref:"infoForm",attrs:{model:t.infoForm,rules:t.validate,"label-width":100}},[s("Form-item",{attrs:{label:"产品名称：",prop:"productName"}},[s("Input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.infoForm.productName,callback:function(e){t.$set(t.infoForm,"productName",e)},expression:"infoForm.productName"}})],1),s("Form-item",{attrs:{label:"产品说明：",prop:"productDesc"}},[s("Tinymce",{attrs:{height:"500"},model:{value:t.infoForm.productDesc,callback:function(e){t.$set(t.infoForm,"productDesc",e)},expression:"infoForm.productDesc"}})],1),s("div",{staticClass:"m-operation"},[s("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){return t.edit("infoForm")}}},[t._v("确认修改")]),s("div",{staticClass:"clearfix"})],1)],1)],1)],1)},o=[],r=(s("7f7f"),s("be51")),c=s("557c"),u=s("6599"),d={components:{Loading:r["a"],Tinymce:c["a"]},props:{productId:{type:String,default:""}},data:function(){return{pageLoading:!1,infoForm:{productName:"",productDesc:""},validate:{productName:[{required:!0,message:"产品名称不能为空",trigger:"blur"}]}}},created:function(){this.getDetail()},methods:{getDetail:function(){var t=this;this.pageLoading=!0,u["a"].GetProdInfo(this.productId).then((function(e){t.pageLoading=!1;var s=e.data;200==e.code?t.infoForm=s:t.$Message.warning(e.msg)})).catch((function(t){return console.log(t)}))},edit:function(t){var e=this;this.$refs[t].validate((function(t){t?(e.pageLoading=!0,u["a"].EditProduct(e.infoForm,e.productId).then((function(t){e.pageLoading=!1,200==t.code?(e.$Message.success("信息修改成功!"),e.getDetail()):e.$Message.warning(t.msg)})).catch((function(t){return console.log(t)}))):e.$Message.error("提交失败！填写有误")}))}}},l=d,p=(s("7457"),s("2877")),m=Object(p["a"])(l,i,o,!1,null,null,null),f=m.exports,h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-case-list"},[t.pageLoading?s("Loading"):s("div",[s("div",{staticClass:"case-pic-list"},[s("swiper",{ref:"caseList",attrs:{options:t.swiperOption}},[t._l(t.caseList,(function(e,a){return s("swiper-slide",{key:a},[s("div",{class:t.caseIndex===a?"swiper-active":"swiper-div",on:{click:function(e){return t.showThisCase(a)}}},[s("img",{attrs:{src:e.img},on:{error:t.notFoundPic}}),s("span",[t._v(t._s(e.title))])])])})),s("swiper-slide",[s("div",{staticClass:"u-add-btn",on:{click:t.addCase}},[t._v("+ 新增案例")])])],2),s("a",{staticClass:"swiper-btn-prev",on:{click:function(e){return t.swiperPrev()}}}),s("a",{staticClass:"swiper-btn-next",on:{click:function(e){return t.swiperNext()}}})],1),t.caseList.length?s("div",{staticClass:"case-cont"},[s("div",{staticClass:"case-cont-item"},[s("span",{staticClass:"item-label"},[t._v("案例标题：")]),s("span",{staticClass:"item-info"},[t._v(t._s(t.caseInfo.title))])]),s("div",{staticClass:"case-cont-item"},[s("span",{staticClass:"item-label"},[t._v("案例封面：")]),s("img",{staticClass:"item-info",attrs:{src:t.caseInfo.img},on:{error:t.notFoundPic}})]),s("div",{staticClass:"case-cont-item"},[s("span",{staticClass:"item-label"},[t._v("品牌名称：")]),s("span",{staticClass:"item-info"},[t._v(t._s(t.caseInfo.brand))])]),s("div",{staticClass:"case-cont-item"},[s("span",{staticClass:"item-label"},[t._v("更新时间：")]),s("span",{staticClass:"item-info"},[t._v(t._s(t.caseInfo.updateTime))])]),s("div",{staticClass:"m-operation"},[s("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:t.editCase}},[t._v("编辑")]),s("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:t.deleteCase}},[t._v("删除")]),s("div",{staticClass:"clearfix"})],1)]):t._e()]),s("Modal",{attrs:{width:"500"},on:{"on-cancel":function(e){return t.closeModal("paramsForm")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("p",{attrs:{slot:"header"},slot:"header"},[s("span",{domProps:{textContent:t._s(""==t.paramsForm.title?"新增版块":"编辑版块")}})]),s("div",[s("Form",{ref:"paramsForm",attrs:{model:t.paramsForm,rules:t.validate,"label-width":100}},[s("Form-item",{attrs:{label:"案例标题：",prop:"title"}},[s("Input",{attrs:{placeholder:"请输入案例标题"},model:{value:t.paramsForm.title,callback:function(e){t.$set(t.paramsForm,"title",e)},expression:"paramsForm.title"}})],1),s("Form-item",{attrs:{label:"案例图片：",prop:"img"}},[s("SingleImage",{attrs:{src:t.paramsForm.img,preview:!0},on:{"update:src":function(e){return t.$set(t.paramsForm,"img",e)},"get-img-url":t.setCaseImg}})],1),s("Form-item",{attrs:{label:"品牌名称：",prop:"brand"}},[s("Input",{attrs:{placeholder:"请输入案例品牌名称"},model:{value:t.paramsForm.brand,callback:function(e){t.$set(t.paramsForm,"brand",e)},expression:"paramsForm.brand"}})],1)],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{size:"large"},on:{click:function(e){return t.closeModal("paramsForm")}}},[t._v("取消")]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){return t.operation("paramsForm",t.operateType)}}},[t._v("确定")])],1)])],1)},g=[],v=s("a6c3"),w=(s("ff51"),s("ed08")),b=(s("dfa4"),{components:{Loading:r["a"],SingleImage:v["a"]},props:{productId:{type:String,default:""}},computed:{swiper:function(){return this.$refs.caseList.swiper}},data:function(){return{pageLoading:!1,swiperOption:{notNextTick:!0,prevButton:".swiper-button-prev",nextButton:".swiper-button-next",slidesPerView:5,spaceBetween:30,freeMode:!0},caseIndex:0,caseList:[],operateType:0,showModal:!1,caseInfo:{img:"",title:"",brand:"",updateTime:""},paramsForm:{img:"",title:"",brand:"",updateTime:""},validate:{title:[{required:!0,message:"案例名称不能为空",trigger:"blur"}]}}},created:function(){this.getCaseList(this.productId)},mounted:function(){console.log("this is current swiper instance object",this.swiper)},methods:{swiperPrev:function(){this.swiper.slidePrev()},swiperNext:function(){this.swiper.slideNext()},getCaseList:function(t){var e=this;u["a"].GetCaseList(this.productId).then((function(t){if(200==t.code){t.data;void 0==t.data?e.caseList=[]:(e.caseList=t.data,e.showThisCase(e.caseIndex))}else console.log(t)})).catch((function(t){return console.log(t)}))},showThisCase:function(t){this.caseIndex=t,this.caseInfo.title=this.caseList[t].title,this.caseInfo.brand=this.caseList[t].brand,this.caseInfo.updateTime=this.caseList[t].updateTime,this.caseInfo.img=this.caseList[this.caseIndex].img},closeModal:function(t){this.showModal=!1,this.$refs[t].resetFields()},openModel:function(){this.showModal=!0},editCase:function(){this.operateType=2,this.paramsForm.title=this.caseList[this.caseIndex].title,this.paramsForm.brand=this.caseList[this.caseIndex].brand,this.paramsForm.img=this.caseList[this.caseIndex].img,this.openModel()},addCase:function(){if(this.caseList.length>=5)return this.$Message.warning("最多只能添加5个案例！"),!1;this.operateType=1,this.paramsForm.title="",this.paramsForm.brand="",this.paramsForm.img="",this.openModel()},deleteCase:function(){var t=this;this.$Modal.confirm({okText:"确认",render:function(t){return t("p",{},"是否确认删除？")},onOk:function(){var e=t.caseList.length-1;u["a"].DelCase(t.productId,t.caseIndex).then((function(s){200==s.code?(t.caseIndex==e&&t.caseIndex--,t.$Message.success("删除成功!"),t.getCaseList(t.productId)):console.log(s)})).catch((function(t){return console.log(t)}))}})},operation:function(t,e){var s=this;this.$refs[t].validate((function(a){a?(s.paramsForm.updateTime=Object(w["g"])(new Date),1==e?u["a"].AddCase(s.paramsForm,s.productId).then((function(e){200==e.code?(s.closeModal(t),s.$Message.success("新增成功!"),s.getCaseList(s.productId)):console.log(e)})).catch((function(t){return console.log(t)})):2==e&&u["a"].EditCase(s.paramsForm,s.productId,s.caseIndex).then((function(e){200==e.code?(s.closeModal(t),s.$Message.success("编辑成功!"),s.getCaseList(s.productId)):console.log(e)})).catch((function(t){return console.log(t)}))):s.$Message.error("提交失败！填写有误")}))},notFoundPic:function(t){Object(w["o"])(t,2)}}}),C=b,I=(s("39d3"),Object(p["a"])(C,h,g,!1,null,null,null)),F=I.exports,L={components:{ProductInfo:f,CaseList:F},data:function(){return{productId:""}},created:function(){this.$store.commit("SET_BREADCRUMB",[{name:"首页",path:"/Home"},{name:"产品列表",path:"/Examples/ProductManage/List"},{name:"产品详情",path:""}]),this.productId=Object(w["j"])("id")},methods:{}},P=L,_=(s("867b"),Object(p["a"])(P,a,n,!1,null,"886287fc",null));e["default"]=_.exports},de2e:function(t,e,s){},dfa4:function(t,e,s){}}]);