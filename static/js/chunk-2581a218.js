(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2581a218"],{"7f87":function(e,t,n){"use strict";n("7514");var r=n("56c6");t["a"]={GetUserInfo:function(e){var t=r["a"].GetQuery("_User");return t.equalTo("token","==",e),t.select("username","role","userFace","nickName","realName","gender"),new Promise((function(e,n){t.find().then((function(t){e({code:200,data:t[0]})})).catch((function(e){return n(e)}))}))},EditProfile:function(e,t){return new Promise((function(n,o){r["a"].EditOne("_User",t,e).then((function(e){return n(e)})).catch((function(e){return o(e)}))}))},ChangePwd:function(e,t){var n=r["a"].GetQuery("_User");return n.equalTo("token","==",t),n.equalTo("password","==",e.oldPassword),new Promise((function(t,r){n.find().then((function(n){n.length?(n.set("password",e.newPassword),n.saveAll().then((function(){return t({code:200,msg:"操作成功！"})})).catch((function(e){return r(e)}))):t({code:404,msg:"旧密码不正确！"})})).catch((function(e){return r(e)}))}))}}},"818a":function(e,t,n){"use strict";var r=n("a0fa"),o=n.n(r);o.a},"8f06":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"g-content"},[e.pageLoading?n("Loading"):n("Form",{ref:"infoForm",staticStyle:{width:"700px"},attrs:{model:e.infoForm,rules:e.validate,"label-width":110}},[n("Form-item",{attrs:{label:"账号："}},[n("span",[e._v(e._s(e.infoForm.username))])]),n("Form-item",{attrs:{label:"用户昵称：",prop:"nickName"}},[n("Input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入您的真实姓名"},model:{value:e.infoForm.nickName,callback:function(t){e.$set(e.infoForm,"nickName",t)},expression:"infoForm.nickName"}})],1),n("Form-item",{attrs:{label:"真实姓名："}},[n("Input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入您的真实姓名"},model:{value:e.infoForm.realName,callback:function(t){e.$set(e.infoForm,"realName",t)},expression:"infoForm.realName"}})],1),n("Form-item",{attrs:{label:"头像："}},[n("ImageCropper",{attrs:{src:e.infoForm.userFace,preview:!0,fixed:!0,fixedNumber:[1,1]},on:{"get-img-url":e.setFace}})],1),n("Form-item",{attrs:{label:"性别：",prop:"gender"}},[n("Radio-group",{model:{value:e.infoForm.gender,callback:function(t){e.$set(e.infoForm,"gender",t)},expression:"infoForm.gender"}},[n("Radio",{attrs:{label:"男"}},[e._v("男")]),n("Radio",{attrs:{label:"女"}},[e._v("女")])],1)],1),n("Form-item",[n("Button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("infoForm")}}},[e._v("确认")])],1)],1)],1)},o=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),i=n("be51"),c=n("e634"),s=n("7f87"),u=n("2f62");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={components:{Loading:i["a"],ImageCropper:c["a"]},computed:f({},Object(u["b"])(["token"])),data:function(){return{pageLoading:!1,infoForm:{username:"",nickName:"",realName:"",userFace:n("3509"),gender:"男"},validate:{nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}]}}},created:function(){this.$store.commit("SET_BREADCRUMB",[{name:"首页",path:"/Home"},{name:"个人资料",path:"/Profile"}]),this.getProfile()},methods:{submit:function(e){var t=this;this.$refs[e].validate((function(e){e?s["a"].EditProfile(t.infoForm,t.infoForm.objectId).then((function(e){200==e.code?(t.getProfile(),t.$Message.success("资料修改成功！")):t.$Message.error("资料修改失败！")})).catch((function(e){return console.log(e)})):t.$Message.error("提交失败！填写有误")}))},getProfile:function(){var e=this;this.pageLoading=!0,s["a"].GetUserInfo(this.token).then((function(t){200==t.code?(console.log(t),e.pageLoading=!1,e.infoForm=t.data,e.$store.commit("SET_USER",{face:e.infoForm.userFace,nickName:e.infoForm.nickName,role:e.infoForm.role,id:e.infoForm.objectId})):e.$Message.error("无该用户数据!")})).catch((function(e){return console.log(e)}))},setFace:function(e){console.log(e),this.infoForm.userFace=e}}},d=m,p=n("2877"),g=Object(p["a"])(d,r,o,!1,null,"6d76cb02",null);t["default"]=g.exports},a0fa:function(e,t,n){},be51:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-load",attrs:{id:"loading"}},[n("Spin",[n("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),n("div",[e._v("玩命加载中...")])],1)],1)},o=[],a={name:"loading",data:function(){return{}}},i=a,c=(n("818a"),n("2877")),s=Object(c["a"])(i,r,o,!1,null,"f624f8be",null);t["a"]=s.exports}}]);
//# sourceMappingURL=chunk-2581a218.js.map