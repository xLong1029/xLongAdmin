(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a8748848"],{"491c":function(t,e,n){"use strict";var i=n("6de5"),a=n.n(i);a.a},"57f7":function(t,e,n){},"62cd":function(t,e,n){"use strict";var i=n("57f7"),a=n.n(i);a.a},"648f":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"editableTable"}},[n("table",{ref:"table",staticClass:"m-table",attrs:{width:"100%",cellpadding:"0",cellspacing:"0"}},[t._l(t.title,(function(e,i){return n("th",{key:"th"+i,style:{width:e.width+"px"},attrs:{align:e.align}},["CheckBox"==e.type?n("Checkbox",{on:{"on-change":function(e){return t.selectAll(t.checkAll)}},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}}):n("span",[t._v(t._s(e.title))])],1)})),t.data.length?t._l(t.data,(function(e,i){return n("tr",{key:"tr"+i},t._l(t.title,(function(a,o){return n("td",{key:"td"+o,attrs:{align:a.align}},["CheckBox"==a.type?n("Checkbox",{on:{"on-change":function(n){return t.selectRow(i,e.isCheck)}},model:{value:e.isCheck,callback:function(n){t.$set(e,"isCheck",n)},expression:"item.isCheck"}}):t._e(),"Text"==a.type?n("span",[t._v(t._s(e[a.key]))]):t._e(),"Input"==a.type?n("Input",{model:{value:e[a.key],callback:function(n){t.$set(e,a.key,n)},expression:"item[th.key]"}}):t._e(),"UploadImg"==a.type?n("div",[n("div",{staticClass:"upload-img"},[n("img",{staticClass:"show-img",attrs:{src:e[a.key],alt:"图片加载失败"},on:{error:t.notFoundPic}})]),n("div",{staticClass:"upload-btn"},[n("Button",{attrs:{type:"default",disabled:""==e[a.key],icon:"ios-eye-outline"},on:{click:function(e){return t.viewImage(i)}}},[t._v("查看图片")]),n("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"default",icon:"ios-cloud-upload-outline"},on:{click:function(e){return t.uploadClick(i)}}},[t._v("上传图片")])],1)]):t._e(),"Button"==a.type?n("div",t._l(a.button,(function(e,a){return n("span",{key:a},[n("Button",{staticClass:"table-btn",style:{"min-width":e.minWidth+"px"},attrs:{type:e.type,size:e.size},on:{click:function(n){return t.buttonOperate(e,i)}}},[t._v("\n                  "+t._s(e.text)+"\n                  ")])],1)})),0):t._e()],1)})),0)})):n("tr",[n("td",{attrs:{colspan:t.title.length,align:"center"}},[t._v(t._s(t.emptyText))])])],2),n("input",{ref:"imgFile",attrs:{type:"file",accept:t.imgFormat,hidden:""},on:{change:t.selectFile}}),n("Modal",{attrs:{title:"查看图片"},model:{value:t.showImgModal,callback:function(e){t.showImgModal=e},expression:"showImgModal"}},[n("img",{staticStyle:{width:"100%"},attrs:{src:t.imgUrl},on:{error:t.notFoundPic}}),n("div",{attrs:{slot:"footer"},slot:"footer"})])],1)},a=[],o=(n("7f7f"),n("ac6a"),n("c5f6"),n("ff51"),n("ed08")),r={name:"editableTable",props:{title:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},emptyText:{type:String,default:"暂无数据"},imgMaxSize:{type:Number,default:2048},imgFormat:{type:Array,default:function(){return["image/jpg","image/jpeg","image/png"]}}},data:function(){return{selectList:[],checkAll:!1,showImgModal:!1,imgUrl:"",rowIndex:-1}},methods:{selectAll:function(t){var e=this;this.data.forEach((function(n){t?(n.isCheck=!0,e.selectList.push(n)):(n.isCheck=!1,e.clearSelect())})),this.$emit("on-all-select",this.selectList)},selectRow:function(t,e){var n=this.data[t];e?this.selectList.push(n):this.removeSelectRow(t),this.$emit("on-select",this.selectList,n)},removeSelectRow:function(t){var e=this,n=this.data[t];this.selectList.forEach((function(t,i){t==n&&(n.isCheck=!1,e.selectList.splice(i,1))}))},clearSelect:function(){this.selectList=[]},viewImage:function(t){this.showImgModal=!0,this.imgUrl=this.data[t].img},uploadClick:function(t,e){this.$refs.imgFile.click(),this.rowIndex=t},selectFile:function(t){var e=this.$refs.imgFile.files;if(e.length>0){var n=e[0].name,i=Math.floor(e[0].size/1024);if(i>this.imgMaxSize)return this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+n+" 太大，不能超过 2M。"}),!1;this.uploadFile(e[0])}else console.log("获取不到文件列表")},uploadFile:function(t){var e=this,n=Bmob.File(t.name,t);n.save().then((function(t){e.data[e.rowIndex].img=t[0].url,e.$Notice.success({title:"图片上传成功!"})}),(function(t){return e.$Notice.error({title:"图片上传失败，请重试！"})}))},buttonOperate:function(t,e){var n=this.data[e];"save"==t.click?this.$emit("on-save",n):"delete"==t.click&&(this.$emit("on-delete",n),n.isCheck&&this.removeSelectRow(e),this.data.splice(e,1))},notFoundPic:function(t){Object(o["o"])(t,2)}}},s=r,c=(n("491c"),n("2877")),l=Object(c["a"])(s,i,a,!1,null,"870c37c8",null);e["a"]=l.exports},"6de5":function(t,e,n){},7418:function(t,e,n){"use strict";var i=n("cd2e"),a=n.n(i);a.a},"78b5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"g-content"},[n("div",{staticClass:"m-operation"},[n("Button",{staticClass:"operation-btn",attrs:{type:"primary"},on:{click:t.openModel}},[t._v("新增")]),n("Button",{staticClass:"operation-btn",attrs:{type:"warning",disabled:0==t.selectList.length},on:{click:t.deleteData}},[t._v("删除")]),n("Button",{staticClass:"operation-btn",attrs:{type:"default"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1),t.pageLoading?n("Loading"):n("div",[n("EditableTable",{attrs:{title:t.title,data:t.listData},on:{"on-select":t.getSelectRowData,"on-all-select":t.getSelectRowData,"on-save":t.saveThis}}),n("Page",{attrs:{"class-name":"m-page","show-elevator":"","show-sizer":"","show-total":"",total:t.page.dataCount,"page-size":t.page.pageSize,current:t.page.pageNo,"page-size-opts":t.page.pageSizeOpts},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}}),n("div",{staticClass:"clearfix"})],1),n("Modal",{attrs:{title:"新增内容"},on:{"on-cancel":function(e){return t.closeModal("paramsForm")}},model:{value:t.showAddModal,callback:function(e){t.showAddModal=e},expression:"showAddModal"}},[n("div",[n("Form",{ref:"paramsForm",attrs:{model:t.paramsForm,rules:t.validate,"label-width":100}},[n("Form-item",{attrs:{label:"内容标题：",prop:"title"}},[n("Input",{model:{value:t.paramsForm.title,callback:function(e){t.$set(t.paramsForm,"title",e)},expression:"paramsForm.title"}})],1),n("Form-item",{attrs:{label:"封面图片："}},[n("SingleImage",{attrs:{src:t.paramsForm.img},on:{"update:src":function(e){return t.$set(t.paramsForm,"img",e)},"get-img-url":t.setCover}})],1),n("Form-item",{attrs:{label:"跳转链接："}},[n("Input",{model:{value:t.paramsForm.url,callback:function(e){t.$set(t.paramsForm,"url",e)},expression:"paramsForm.url"}})],1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{size:"large"},on:{click:function(e){return t.closeModal("paramsForm")}}},[t._v("取消")]),n("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){return t.add("paramsForm")}}},[t._v("确定")])],1)])],1)},a=[],o=(n("8e6e"),n("456d"),n("7f7f"),n("ac6a"),n("bd86")),r=n("a6c3"),s=n("648f"),c=n("be51"),l=(n("ff51"),n("ed08")),u=n("ba7e"),d=n("1b62"),p=n("2f62");function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={components:{SingleImage:r["a"],EditableTable:s["a"],Loading:c["a"]},mixins:[d["e"],d["d"],d["c"],d["f"]],computed:m({},Object(p["b"])(["getImageUrl"]),{apiGetList:function(){var t=this;return function(){return u["a"].GetContList(t.parentId,t.page.pageNo,t.page.pageSize)}},apiAdd:function(){var t=this;return function(){return u["a"].AddContent(t.paramsForm)}},apiDelete:function(){var t=this;return function(){return u["a"].DeleteCont(t.selectList)}},apiEdit:function(){var t=this;return function(){return u["a"].EditContent(t.paramsForm,t.editId)}}}),data:function(){return{pageLoading:!1,checkAll:!1,paramsForm:{title:"",img:"",url:"",parentId:""},validate:{title:[{required:!0,message:"内容标题不能为空",trigger:"blur"}]},parentId:"",editId:"",showAddModal:!1,title:[{title:"全选",key:"selecAll",align:"center",type:"CheckBox",width:"50"},{title:"编号",key:"id",align:"center",type:"Text",width:"100"},{title:"内容标题",key:"title",align:"center",type:"Input"},{title:"封面图片",key:"img",align:"center",type:"UploadImg",width:"300"},{title:"跳转链接",key:"url",align:"center",type:"Input"},{title:"操作",key:"operate",align:"center",type:"Button",button:[{type:"primary",size:"small",minWidth:"64",text:"保存",click:"save"}],width:"180"}],listData:[]}},created:function(){this.$store.commit("SET_BREADCRUMB",[{name:"首页",path:"/Home"},{name:"板块列表",path:"/Examples/SectionManage/List"},{name:"内容管理",path:""}]),this.parentId=Object(l["j"])("id"),this.getTableList(),this.initData(this.listData)},methods:{initData:function(t){t.length>0&&t.forEach((function(t){t.isCheck=!1}))},setListData:function(t){t.length>0?this.listData=t.map((function(t){return{id:t.objectId,title:t.title,img:t.img,url:t.url}})):this.listData=[]},saveThis:function(t){this.editId=t.id,this.paramsForm.parentId=this.parentId,this.paramsForm.title=t.title,this.paramsForm.img=t.img,this.paramsForm.url=t.url,this.editData()},openModel:function(){this.showAddModal=!0,this.paramsForm.title="",this.paramsForm.img="",this.paramsForm.url="",this.paramsForm.parentId=this.parentId},closeModal:function(t){this.showAddModal=!1,this.$refs[t].resetFields()},add:function(t){var e=this;this.$refs[t].validate((function(n){n?(e.addData(),setTimeout((function(){e.closeModal(t)}),500)):e.$Message.error("提交失败！填写有误")}))},getSelectRowData:function(t){var e=this;t.forEach((function(t){return e.selectList.push(t.id)}))},notFoundPic:function(t){Object(l["o"])(t,2)}}},g=h,v=(n("7418"),n("2877")),b=Object(v["a"])(g,i,a,!1,null,"29f67a3b",null);e["default"]=b.exports},"818a":function(t,e,n){"use strict";var i=n("a0fa"),a=n.n(i);a.a},a0fa:function(t,e,n){},a6c3:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-Upload",attrs:{id:"singleImage"}},[""!=t.getImageUrl?n("div",{staticClass:"upload-show"},[n("div",{staticClass:"upload-img-wrap"},[n("img",{staticClass:"upload-image",attrs:{src:t.getImageUrl,alt:"图片加载失败"},on:{error:t.notFoundPic}})]),t.preview?n("div",{staticClass:"upload-mask"},[t.preview?n("Icon",{staticClass:"g-mr10",attrs:{type:"md-eye"},nativeOn:{click:function(e){return t.viewImage(e)}}}):t._e(),n("Icon",{attrs:{type:"md-create"},nativeOn:{click:function(e){return t.uploadClick(e)}}})],1):t._e()]):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showUploadBtn,expression:"showUploadBtn"}],staticClass:"upload-btn",on:{click:t.uploadClick}},[n("Icon",{attrs:{type:"md-camera",size:"20"}}),n("input",{ref:"imgFile",attrs:{type:"file",accept:t.format,hidden:""},on:{change:t.selectFile}})],1),"finished"!=t.uploadStatus?[t.showProgress?n("Progress",{staticStyle:{width:"340px"},attrs:{percent:t.percentage,"hide-info":"","stroke-width":3}}):t._e()]:t._e(),n("br"),n("span",{staticClass:"hint"},[t._v("\n    * 图片格式要求：jpg、jpeg、png，文件大小为\n    "),t.fileSize<1024?n("span",[t._v(t._s(t.fileSize)+"kb")]):n("span",[t._v(t._s(Math.floor(t.fileSize/1024))+"M")]),t._v("\n    以内。\n  ")]),n("div",{staticClass:"clearfix"}),n("Modal",{staticClass:"m-view-img",attrs:{title:"查看图片",width:"600"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[n("img",{attrs:{src:t.getImageUrl},on:{error:t.notFoundPic}}),n("div",{attrs:{slot:"footer"},slot:"footer"})])],2)},a=[],o=(n("7f7f"),n("c5f6"),n("ff51"),n("1b62")),r={name:"singleImage",mixins:[o["f"]],props:{src:{type:String,default:""},preview:{type:Boolean,default:!1},sizeHint:{type:String,default:"100*100px"},fileSize:{type:Number,default:150}},watch:{src:function(t){this.showUploadBtn=!t,this.getImageUrl=t}},data:function(){return{getImageUrl:this.src,showUploadBtn:!this.src}},methods:{uploadFile:function(t){var e=this;this.progressShow();var n=Bmob.File(t.name,t);this.uploadToBomb(n).then((function(t){e.getImageUrl=t[0].url,e.$emit("update:src",e.getImageUrl),e.$emit("get-img-url",e.getImageUrl)})).catch((function(t){return console.log(t)}))}}},s=r,c=(n("62cd"),n("2877")),l=Object(c["a"])(s,i,a,!1,null,"3111636a",null);e["a"]=l.exports},ba7e:function(t,e,n){"use strict";n("ac6a"),n("456d");var i=n("56c6");e["a"]={GetSecList:function(t,e,n){var a=i["a"].GetQuery("Section");return t&&Object.keys(t).length&&(t.id&&a.equalTo("objectId","==",t.id),t.title&&a.equalTo("title","==",t.title),t.type&&a.equalTo("type","==",parseInt(t.type))),new Promise((function(t,o){i["a"].GetListData(a,e,n).then((function(e){return t(e)})).catch((function(t){return o(t)}))}))},AddSection:function(t){return new Promise((function(e,n){i["a"].AddOne("Section",t).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))},EditSection:function(t,e){return new Promise((function(n,a){i["a"].EditOne("Section",e,t).then((function(t){return n(t)})).catch((function(t){return a(t)}))}))},DeleteSec:function(t){return new Promise((function(e,n){i["a"].DelMore("Section",t).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))},GetContList:function(t,e,n){var a=i["a"].GetQuery("SectionCont");return a.equalTo("parentId","==",t),new Promise((function(t,o){i["a"].GetListData(a,e,n).then((function(e){return t(e)})).catch((function(t){return o(t)}))}))},AddContent:function(t){return new Promise((function(e,n){i["a"].AddOne("SectionCont",t).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))},DeleteCont:function(t){return new Promise((function(e,n){i["a"].DelMore("SectionCont",t).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))},EditContent:function(t,e){return console.log(t),new Promise((function(n,a){i["a"].EditOne("SectionCont",e,t).then((function(t){return n(t)})).catch((function(t){return a(t)}))}))}}},be51:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-load",attrs:{id:"loading"}},[n("Spin",[n("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),n("div",[t._v("玩命加载中...")])],1)],1)},a=[],o={name:"loading",data:function(){return{}}},r=o,s=(n("818a"),n("2877")),c=Object(s["a"])(r,i,a,!1,null,"f624f8be",null);e["a"]=c.exports},cd2e:function(t,e,n){}}]);